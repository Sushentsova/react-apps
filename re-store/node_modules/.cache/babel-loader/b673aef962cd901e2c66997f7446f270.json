{"ast":null,"code":"const updateCartItems = (cartItems, item, idx) => {\n  if (item.count === 0) {\n    return [...cartItems.slice(0, idx), ...cartItems.slice(idx + 1)];\n  }\n  if (idx === -1) {\n    return [...cartItems, item];\n  }\n  return [...cartItems.slice(0, idx), item, ...cartItems.slice(idx + 1)];\n};\nconst updateCartItem = function (book) {\n  let item = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  let quantity = arguments.length > 2 ? arguments[2] : undefined;\n  const {\n    id = book.id,\n    count = 0,\n    title = book.title,\n    total = 0\n  } = item;\n  return {\n    id,\n    title,\n    count: count + quantity,\n    total: total + quantity * book.price\n  };\n};\nconst updateOrder = (state, bookId, quantity) => {\n  const {\n    bookList: {\n      books\n    },\n    shoppingCart: {\n      cartItems\n    }\n  } = state;\n  const book = books.find(_ref => {\n    let {\n      id\n    } = _ref;\n    return id === bookId;\n  });\n  const itemIndex = cartItems.findIndex(_ref2 => {\n    let {\n      id\n    } = _ref2;\n    return id === bookId;\n  });\n  const item = cartItems[itemIndex];\n  const newItem = updateCartItem(book, item, quantity);\n  return {\n    orderTotal: 0,\n    cartItems: updateCartItems(cartItems, newItem, itemIndex)\n  };\n};\nconst updateShoppingCart = (state, action) => {\n  if (state === undefined) {\n    return {\n      cartItems: [],\n      orderTotal: 0\n    };\n  }\n  switch (action.type) {\n    case 'BOOK_ADDED_TO_CART':\n      return updateOrder(state, action.payload, 1);\n    case 'BOOK_REMOVED_FROM_CART':\n      return updateOrder(state, action.payload, -1);\n    case 'ALL_BOOKS_REMOVED_FROM_CART':\n      const item = state.shoppingCart.cartItems.find(_ref3 => {\n        let {\n          id\n        } = _ref3;\n        return id === action.payload;\n      });\n      return updateOrder(state, action.payload, -item.count);\n    default:\n      return state.shoppingCart;\n  }\n};\nexport default updateShoppingCart;","map":{"version":3,"names":["updateCartItems","cartItems","item","idx","count","slice","updateCartItem","book","quantity","id","title","total","price","updateOrder","state","bookId","bookList","books","shoppingCart","find","itemIndex","findIndex","newItem","orderTotal","updateShoppingCart","action","undefined","type","payload"],"sources":["C:/Users/User/react-apps/re-store/src/reducers/shopping-cart.js"],"sourcesContent":["const updateCartItems = (cartItems, item, idx) => {\r\n\r\n    if (item.count === 0) {\r\n      return [\r\n        ...cartItems.slice(0, idx),\r\n        ...cartItems.slice(idx + 1)\r\n      ];\r\n    }\r\n  \r\n    if (idx === -1) {\r\n      return [\r\n        ...cartItems,\r\n        item\r\n      ];\r\n    }\r\n  \r\n    return [\r\n      ...cartItems.slice(0, idx),\r\n      item,\r\n      ...cartItems.slice(idx + 1)\r\n    ];\r\n  };\r\n  \r\n  const updateCartItem = (book, item = {}, quantity) => {\r\n  \r\n    const {\r\n      id = book.id,\r\n      count = 0,\r\n      title = book.title,\r\n      total = 0 } = item;\r\n  \r\n    return {\r\n      id,\r\n      title,\r\n      count: count + quantity,\r\n      total: total + quantity*book.price\r\n    };\r\n  };\r\n  \r\n  const updateOrder = (state, bookId, quantity) => {\r\n    const { bookList: { books }, shoppingCart: { cartItems }} = state;\r\n  \r\n    const book = books.find(({id}) => id === bookId);\r\n    const itemIndex = cartItems.findIndex(({id}) => id === bookId);\r\n    const item = cartItems[itemIndex];\r\n  \r\n    const newItem = updateCartItem(book, item, quantity);\r\n    return {\r\n      orderTotal: 0,\r\n      cartItems: updateCartItems(cartItems, newItem, itemIndex)\r\n    };\r\n  };\r\n  \r\n  const updateShoppingCart = (state, action) => {\r\n  \r\n    if (state === undefined) {\r\n      return {\r\n        cartItems: [],\r\n        orderTotal: 0\r\n      }\r\n    }\r\n  \r\n    switch(action.type) {\r\n      case 'BOOK_ADDED_TO_CART':\r\n        return updateOrder(state, action.payload, 1);\r\n  \r\n      case 'BOOK_REMOVED_FROM_CART':\r\n        return updateOrder(state, action.payload, -1);\r\n  \r\n      case 'ALL_BOOKS_REMOVED_FROM_CART':\r\n        const item = state.shoppingCart.cartItems.find(({id}) => id === action.payload);\r\n        return updateOrder(state, action.payload, -item.count);\r\n  \r\n      default:\r\n        return state.shoppingCart;\r\n    }\r\n  };\r\n  \r\n  export default updateShoppingCart;"],"mappings":"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"},"metadata":{},"sourceType":"module"}